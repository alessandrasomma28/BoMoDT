# UrbanDigitalTwin
**UrbanDigitalTwin** is a platform created with the aim of integrating different functionalities belonging to the urban world into a single solution through the use of Digital Twin technology. This technology is mainly found in the adoption of the *Next Generation Service Interfaces* (**NGSI**) information model standard, in its version for supporting linked data, i.e. [**NGSI-LD**](https://www.etsi.org/deliver/etsi_gs/CIM/001_099/009/01.05.01_60/gs_CIM009v010501p.pdf). The use of NGSI standard not only unifies the information exchanged between the various components of the system, but also makes the latter aware of the meaning of the data and the interrelationships between them, increasing the level of semantic interoperability.

## Platform
The platform, designed to be modular, consists of a main core for managing and interacting with Digital Twin instances. Modularity is ensured through the various interfaces provided by the core module and the python module developed specifically to guarantee greater interoperability.
The core module consists mainly of FIWARE components used for a variety of functions:
- [**FIWARE Orion-LD Context Broker**](https://github.com/FIWARE/context.Orion-LD): as the main component of the system, Orion is a broker of Digital Twin instances, referred to here as context entities, which provides NGSI interfaces, both in the v2 and Linked Data versions. Using these interfaces, it is possible to obtain and update context information, activate a notification system for the change of certain context information and register context provider systems. Context entities and their related context information are stored in the noSQL database MongoDB.
- [**FIWARE IoT Agent - JSON Version**](https://github.com/telefonicaid/iotagent-json): this component enables data exchange in NGSI format between Orion and IoT devices using their native protocol. In the JSON version, IoT Agent acts as a bridge between the JSON and NGSI interfaces of the context broker, supporting AMQP, HTTP and MQTT as exchange protocols. Each device identifies itself by communicating its ID and the api keys associated to the previously registered service group.Similarly for Orion, IoT agent also stores registered devices and service groups in MongoDB.
- [**FIWARE QuantumLeap**](https://github.com/orchestracities/ngsi-timeseries-api/): a REST service for storing, querying and retrieving NGSI temporal data. The data are stored in a dedicated time-series database (Timescale DB), associating each record with a time index. QuantumLeap is designed to communicate closely with Orion to receive time data. To do this, QuantumLeap must be subscribed to Orion, specifying which entities are to notify the component when a change occurs. 
- [Grafana](https://grafana.com/oss/grafana/): is a web application used to group, visualise and monitor the data collected by the various components in dedicated dashboards.

The python module in the repository is designed to be able to interact and coordinate these components. For the case study under analysis, this module was configured to simulate urban traffic loops. Using the developed libraries, the process of recording and communicating data is followed in a fully simulated manner.

At present, an [Eclipse SUMO](https://eclipse.dev/sumo/) module for traffic simulation has been integrated into the platform in such a way as to implement the specific case study described below. SUMO is a suite that provides support for the creation, execution and evaluation of traffic simulations. Among the various support tools are functions for network import and modification, algorithms for route calculation, emission map generators, etc.

## Case Study
UrbanDigitalTwin was born from the study of a specific case study and the resulting development of a solution for it. This case concerns the traffic management of two neighbourhoods in the city of Bologna. Starting from the SUMO repository of simulation scenarios, the scenario of two neighbourhoods of Bologna was considered, named after the main streets that distinguish them, namely "via Costa" and "via Pasubio". These data, combined with real measurements of Bologna's traffic, give room for the construction of a Digital Twin model. 

In a nutshell, by interacting with the sensors in these neighbourhoods (which in the experimentation are simulated), a closed loop can be created in which the data collected is stored by the Digital Twin, which in turn, by means of calculations and exploiting the appropriate services, can make the traffic situation detected and predicted. With this feedback, it is possible to intervene on the simulation by modifying the traffic flow (e.g. through traffic lights).

The activity involved a first phase of collecting and pre-processing real data for simulation in SUMO (described in the [appropriate section](https://github.com/alessandrasomma28/UrbanDigitalTwin/tree/main/SUMO/joined)), and a second phase of building a system in python for integrating this data with FIWARE components in an automated manner.
